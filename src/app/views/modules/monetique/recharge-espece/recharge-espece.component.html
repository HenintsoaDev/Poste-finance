<div class="container">
    <!-- Étapes -->
  <div *ngIf="currentStep == 1" class="step step-1">
    <div class="card shadow-sm mb-4">
      <div class="card-header bg-primary text-white">Rechercher un compte</div>
      <div class="card-body">
        <form>
          <div class="row align-items-center justify-content-center g-3">
            <div class="col-md-3 text-end fw-bold">
              Téléphone
            </div>
            <div class="col-md-4">
              <div class="input-group">
                <input type="text"
                    name="phone_client" 
                    [(ngModel)]="telephone" 
                    placeholder="3X XX XXX XX"
                    autocomplete="off"
                    class="form-control form-icon-input"
                    oninput="this.value=this.value.replace(/[^0-9]/g,'');"
                    ng2TelInput
                    [ng2TelInputOptions]="{
                        allowDropdown: true,
                        autoHideDialCode: false,
                        autoPlaceholder: 'on',
                        formatOnDisplay: true,
                        hiddenInput: 'full_number',
                        initialCountry: currenCode,
                        nationalMode: false,
                        preferredCountries: ['mg', 'sn'],
                        separateDialCode: true,
                        utilsScript: '../../assets/js/tel-utils.js' 
                    }"
                    (hasError)="onError($event)"
                    (ng2TelOutput)="getNumber($event)"
                    (intlTelInputObject)="telInputObject($event)"
                    (countryChange)="onCountryChange($event)"
                >
              </div>
            </div>
            <div class="col-md-2">
              <button type="button" class="btn btn-orange" (click)="goToStep(2)">Rechercher</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Étape 2 -->
  <div *ngIf="currentStep == 2" class="step step-2">
    <!-- Bénéficiaire -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-primary text-white">Bénéficiaire</div>
      <div class="card-body row g-3">
        <div class="col-md-6">
          <p><strong>Numéro carte :</strong> ********3637</p>
          <p><strong>Type de compte :</strong> E-poketra</p>
          <p><strong>Nom du bénéficiaire :</strong> Elhadji Alioune TOUREMAMAMA</p>
          <p><strong>Téléphone :</strong> ********5392</p>
        </div>
        <div class="col-md-6">
          <p><strong>Date d'expiration :</strong> 14 Novembre 2028</p>
          <p><strong>Email :</strong> younaby.com</p>
          <p><strong>Adresse :</strong> Nord foire</p>
        </div>
      </div>
    </div>

    <!-- Rechargement -->
    <div class="card shadow-sm">
      <div class="card-header bg-secondary text-white">Rechargement par espèce</div>
      <div class="card-body">
        <form>
          <div class="mb-3">
            <label class="form-label">Numéro de série</label>
            <input type="text" class="form-control" value="12714486" readonly>
          </div>
          <div class="mb-3">
            <label class="form-label">Calcul de frais (*)</label><br>
            <div class="form-check form-check-inline">
                <label class="form-check-label" for="frais1">Dont frais</label>&nbsp;&nbsp;
                <input class="" type="radio" [(ngModel)]="fraisType" [checked]="fraisType == 'dont_frais'" name="frais" id="frais1" value="dont_frais">
            </div>
            <div class="form-check form-check-inline">
                <label class="form-check-label" for="frais2">Frais en sus</label>&nbsp;&nbsp;
                <input class="" type="radio" [(ngModel)]="fraisType" [checked]="fraisType == 'frais_en_sus'" name="frais" id="frais2" value="frais_en_sus">
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Montant (Ar)</label>
            <input type="number" [(ngModel)]="montantRecharge" class="form-control" min="0" placeholder="Entrez le montant à recharger">
          </div>
          <div class="mb-3">
            <label class="form-label">Motifs</label>
            <input type="text" class="form-control" placeholder="Entrez les motifs">
          </div>

          <div class="row mb-3">
            <div class="col-md-4"><strong>Montant à recharger :</strong> {{ montantRecharge }} {{ __('global.currency') }}</div>
            <div class="col-md-4"><strong>Commission :</strong> 0 {{ __('global.currency') }}</div>
            <div class="col-md-4"><strong>Montant total :</strong> {{ montantRecharge }} {{ __('global.currency') }}</div>
          </div>

          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" (click)="goToStep(1)">{{ __('global.back') }}</button>
            <button type="submit" class="btn btn-green" [disabled]="montantRecharge == 0 || fraisType == ''"   (click)="confirmPaiement()">Recharger</button>
          </div>
        </form>
      </div>
    </div>
  </div>

    <!-- Etape 3 -->
    <div *ngIf="currentStep === 3" class="step step-3">
        <div class="card shadow-sm">
            <div class="card-header bg-secondary text-white">Entrez le code de confirmation</div>
            <div class="card-body">
                <p class="text-muted">Un code a été envoyé par SMS</p>
                <div class="mb-3 w-50 mx-auto">
                <input
                    type="text"
                    maxlength="6"
                    class="form-control text-center"
                    [(ngModel)]="codeConfirmation"
                    name="code"
                    placeholder="Entrez le code de confirmation"
                />
                </div>
                <div class="d-flex justify-content-between mt-3">
                    <button class="btn btn-secondary" (click)="goToStep(2)">Retour</button>
                    <button class="btn btn-green" (click)="goToStep(4)">Confirmer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÉTAPE 4 : Message de succès -->
    <div *ngIf="currentStep === 4" class="step step-4">
        <div class="card alert-success text-center p-4">
            <h4 class="alert-heading">✅ {{ __('global.transaction-success') }} !</h4>
            <p>Le rechargement de <strong>{{ montantRecharge }} Ar</strong> a été effectué avec succès.</p>
            <div class="d-flex justify-content-center">
              <button class="btn btn-primary mt-3" style="width: 250px;" (click)="goToStep(1)">
                {{__('global.back_home')}}
              </button>
              <button class="btn btn-secondary mt-3" style="width: 250px;">
                {{ __('global.print_ticket') }}
              </button>
            </div>
        </div>
    </div>
</div>
